<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">javascript/Events.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="identifiers.html">Identifier</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div data-ice="classWrap">
  <h2>Class</h2>
  <ul>
    
  <li data-ice="classDoc"><span><a href="class/javascript/Buffer.js~Buffer.html">Buffer</a></span></li>
<li data-ice="classDoc"><span><a href="class/javascript/Event.js~Event.html">Event</a></span></li>
<li data-ice="classDoc"><span><a href="class/javascript/Events.js~Events.html">Events</a></span></li>
<li data-ice="classDoc"><span><a href="class/javascript/FileSystem.js~FileSystem.html">FileSystem</a></span></li>
</ul>
</div>










</nav>

<div class="content" data-ice="content"><h1 data-ice="title">javascript/Events.js</h1>
<pre class="source-code line-number"><code class="prettyprint linenums" data-ice="content">/**
 * Events base class for subscribing to and firing events
 * 
 * @example 
 * class MyObject extends Events { };
 * $events = new MyObject();
 * $events.on(&quot;test&quot;,function);
 * $events.fire(&quot;test&quot;, args...);
 * $events.off(&quot;test&quot;, function);
 */
export class Events {
	/** Creates an events system | Should be extended */
	constructor(){
		/** @type {Object} */
		this.ids = {};
	}
	
/**
 * Subscribe to an event
 * @param {String}   event Event name
 * @param {Function} fn    Event callback
 */
	on(event, fn){
		this.addEvent(event,fn,-1);
	}

/**
 * Subscribe to an event and unsubscribe after it has been fired once
 * @param {String}   event Event name
 * @param {Function} fn    Event callback		
 */
	one(event,fn){
		this.addEvent(event,fn,0);
	}
/**
 * Subscribe to an event and unsubscribe after a set amount of times
 * @param {String}   event Event name
 * @param {Function} fn    Event callback
 * @param {Number}   times Times event can fire	
 */
	some(event,fn,times){
		this.addEvent(event,fn,times-1);
	}
	
/**
 * Unsubscribe from an event
 * @param {String}   event Event name
 * @param {Function} fn    Function/Callback used to subscribe
 */
	off(event,fn){
		if(this.ids[event])
			for(var id in this.ids[event])
				if(this.ids[event][id].fn == fn)
					delete this.ids[event][id];
	}
	
/**
 * Add an event
 * @param {String}   event Event name
 * @param {Function} fn    Event callback
 * @param {Number}   type  Event type (-1 infinite, 0 once, 0 &gt; times)
 */
	addEvent(event,fn,type){
		if(!this.ids[event])this.ids[event] = [];
		this.ids[event].push(new Event(event,fn,type));	
	}

/**
 * Fire an event
 * @param   {String}  event Event name
 * @returns {Boolean} Returning 0 will cancel the event bubble
 */
	fire( event ){
		var args = [];
		for(var i in arguments){
			if(i != 0) args.push(arguments[i]);
		}
		
		for(var id in this.ids[event]){
			var fn = this.ids[event][id].fn;
			var ret = fn.apply(null, args);	
			
			if(this.ids[event][id].type == 0) delete this.ids[event][id];
			else if(this.ids[event][id].type &gt; 0) this.ids[event][id].type--;

			// This is a special case for PlayerCommandText and RconCommand so it returns correctly
			if(event == &quot;PlayerCommandText&quot; || event == &quot;RconCommand&quot;){
				if(ret === 1){
					return 1;
				}
			} else {
				if(ret === 0){
					return 0;
				}
			}
		}
	}
};</code></pre>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.1.2)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
